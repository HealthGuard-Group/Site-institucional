<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Logs de Acesso</title>
  <link rel="shortcut icon" type="imagex/png" href="../assets/icon/healthguard_icone.png">
  <link rel="stylesheet" href="../css/global.css">
  <link rel="stylesheet" href="../css/menu_bar.css">
  <link rel="stylesheet" href="../css/acessos.css">

</head>

<body onload="validarSessao()">


  <!-- Começo do Menu -->
  <div class="menu-lateral">
    <div class="pai-icones-superiores">
      <div id="logo">
        <img src="../assets/imgs/HealthGuard_icone_BRANCO_fundo_transparente.png" alt="HealthGuard"
          class="icone-logo-pequena">
      </div>
      <br>
      <div class="icone-box" id="monitoramento_redirecionamento">
        <img src="../assets/imgs/icone_monitoramento.png" alt="Foto" class="icone-menu-1">
        <div class="texto-icone oculto">Monitoramento</div>
      </div>
      <hr class="separador">
      <div class="icone-box" id="gestao_redirecionamento">
        <img src="../assets/imgs/icone_gestao_usuarios.png" alt="Foto" class="icone-menu-2">
        <div class="texto-icone oculto">Gestão de funcionários</div>
      </div>
      <hr class="separador">
      <div class="icone-box" id="alertas_redirecionamento">
        <img src="../assets/imgs/icone_alerta.png" alt="Foto" class="icone-menu-3">
        <div class="texto-icone oculto">Histórico de Alertas</div>
      </div>
      <hr class="separador">
      <div class="icone-box" id="gestao_convites">
        <img src="../assets/imgs/icone-convite2.png" alt="Foto" class="icone-menu-2">
        <div class="texto-icone oculto">Convites</div>
      </div>
      <hr class="separador">
      <div class="icone-box" id="suporte_redirecionamento">
        <img src="../assets/imgs/icone_suporte.png" alt="Foto" class="icone-menu-4">
        <div class="texto-icone oculto">Suporte</div>
      </div>
    </div>
    <div class="pai-icones-inferiores">
      <hr class="separador-forte">
      <div class="icone-box-inferior" id="tela_perfil">
        <img src="../assets/imgs/icone_perfil.png" alt="Foto" class="icone-menu-5">
        <div class="texto-icone oculto" id="nome_usuario">Perfil</div>
      </div>
      <hr class="separador">
      <div class="icone-box-inferior" id="sair_conta_redirecionamento">
        <img src="../assets/imgs/icone_log-out.png" alt="Foto" class="icone-menu-6">
        <div class="texto-icone oculto">Sair da conta</div>
      </div>
    </div>
  </div>
  <!-- Fim do Menu -->

  <div class="container-geral">

    <!-- CONTEÚDO PRINCIPAL -->
    <div class="conteudo">

      <h2 class="titulo">Logs de Acesso</h2>
      <div class="texto-topico">
        Histórico de Logs Gerais:
      </div>

      <div class="filtros">
        <select class="filtro">
          <option>Filtrar por</option>
          <option>Data</option>
          <option>Usuário</option>
        </select>

        <input type="text" placeholder="Usuário" class="campo-usuario">
      </div>

      <table class="tabela" id="tabela">
        <tr class="linha cabecalho">
          <td class="coluna">Data/Hora</td>
          <td class="coluna">Usuário</td>
          <td class="coluna">E-mail</td>
          <td class="coluna">Descrição</td>
          <td class="coluna">Resultado</td>
          <td class="coluna">Máquina</td>
        </tr>

        <tr class="linha">
          <td class="coluna">2025-11-12 16:14:25</td>
          <td class="coluna">João Silva</td>
          <td class="coluna">joao.silva@email.com</td>
          <td class="coluna">Cadastro Máquina</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>

        <tr class="linha">
          <td class="coluna">2025-11-12 16:14:25</td>
          <td class="coluna">João Silva</td>
          <td class="coluna">joao.silva@email.com</td>
          <td class="coluna">Cadastro Máquina</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>

        <tr class="linha">
          <td class="coluna">2025-11-12 16:14:25</td>
          <td class="coluna">João Silva</td>
          <td class="coluna">joao.silva@email.com</td>
          <td class="coluna">Cadastro Máquina</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>

        <tr class="linha">
          <td class="coluna">2025-11-12 16:14:25</td>
          <td class="coluna">João Silva</td>
          <td class="coluna">joao.silva@email.com</td>
          <td class="coluna">Cadastro Máquina</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>

        <tr class="linha">
          <td class="coluna">2025-11-12 16:14:25</td>
          <td class="coluna">João Silva</td>
          <td class="coluna">joao.silva@email.com</td>
          <td class="coluna">Cadastro Máquina</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>

        <tr class="linha">
          <td class="coluna">2025-11-12 16:14:25</td>
          <td class="coluna">João Silva</td>
          <td class="coluna">joao.silva@email.com</td>
          <td class="coluna">Cadastro Máquina</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>

        <tr class="linha">
          <td class="coluna">2025-11-12 16:14:25</td>
          <td class="coluna">João Silva</td>
          <td class="coluna">joao.silva@email.com</td>
          <td class="coluna">Cadastro Máquina</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>

      </table>




    </div>
  </div>

  <script src="../js/menu-lateral.js"></script>
  <script src="../js/validarSessao.js"></script>

</body>

</html>

<script>
  function buscarDadosLogs() {
    var variaveis = puxarVariaveis()
    console.log(variaveis)
    variaveis = variaveis.idUnidadeAtendimento
    console.log(variaveis)
    tabela.innerHTML = `
        <tr class ="linha cabecalho">
          <td class="coluna">Data/Hora</td>
          <td class="coluna">Usuário</td>
          <td class="coluna">E-mail</td>
          <td class="coluna">Descrição</td>
          <td class="coluna">Resultado</td>
          <td class="coluna">Máquina</td>
        </tr>`
    fetch(`/acessos/buscarDadosLogs/${variaveis}`, {
      method: "GET",
    })
      .then(resposta => {
        return resposta.json();
      })
      .then(resposta => {
        console.log(resposta)
        // var dados_filtrados = filtrarFuncionarios(resposta)
        atualizarTabela(resposta)
        // funcionarios = dados_filtrados;

        // atualizarTabela(resposta)
      })
      .catch(function (resposta) {
        console.log(`Erro no catch: ${resposta}`);
      });
  }

  function atualizarTabela(dados) {
    console.log("Respota entrando na função:", dados)
    // let variaveis = puxarVariaveis()
   // let hora = new Date(dados[i].horarioDaAcao)
    //hora = horarioDaAcao.toLocaleDateString('pt-BR')


    for (let i = 0; i < dados.length; i++) {

      tabela.innerHTML += `
          <tr class="linha">
          <td class="coluna">${dados[i].horarioDaAcao}</td>
          <td class="coluna">${dados[i].nome}</td>
          <td class="coluna">${dados[i].email}</td>
          <td class="coluna">${dados[i].acao}</td>
          <td class="coluna sucesso"><span class="bolinha verde"></span><span style="color: #00aa28;">Sucesso</span>
          </td>
          <td class="coluna">Máquina A-02</td>
        </tr>`

    }
  }


</script>